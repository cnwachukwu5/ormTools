<!DOCTYPE html>
<html lang="en" 
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:h="http://java.sun.com/jsf/html" 
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<h:head>
	<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	<meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css"/>
    
	<title>Operational Risk Management Tools</title>
	  <style>
		html, body {
    		height: 100%;
    		width: 100%;
		}
		body{
			overflow-x: hidden;
			font-size: 12px;
			background-color: #f5f5f5;
		}
		.contain-fluid{
			width:100%;
    		height:100%;
		}
		.sidebar {
    		position: fixed;
			height:100%;
    		background:#f8f8ff;
		}
		
		.contents{
			position: fixed;
			left: 16.7%;
			overflow-y: auto;
			
		}
		ul.menu {
				list-style-type: none;
				margin: 0;
				padding: 0;
				display: block;
				width:100%;
				margin-bottom: 100%;
				
		}
		li a {
				display: block;
				color: #000;
				padding: 10px 16px;
				text-decoration: none;
				width:100%
			}
		li a:hover {
				background-color: #ff6347;
				color: white;
				text-decoration: none;
			}
			div{
				margin:0; padding:0;
			}
			.dropbtn {
    		display:block;
    		padding: 2 15px;
    		font-size: 13px;
    		border: none;	
    		cursor: pointer;
    		width:100%;
		}
		
		.dropdown {
    		position: relative;
    		display: inline-block;
    		width:100%;
		}
		
		.dropdown-content {
    		display: none;
    		position: absolute;
    		background-color: #f9f9f9;
    		width:100%;
    		z-index: 1;
		}
		.dropdown-content a {
    		color: black;
    		padding: 12px 16px;
    		text-decoration: none;
    		display: block;
		}
		
		.dropdown-content a:hover {
			background-color: #ff6347;
			color: white;
			}

		.dropdown:hover .dropdown-content {
   		 display: block;
		}

		.dropdown:hover .dropbtn {
    		background-color: silver;
		}
		
	</style>
</h:head>
<h:body>
	<div class="container navbar-inverse" style="width:100%">
			<div class="row">
				<div class="col-md-9 col-lg-9">
					<div class="navbar-header" style="margin-left:3%;">
						<a class="navbar-brand" href="#">Operational Risk Management Tool</a>
					</div>
				</div>
				<div class="col-md-3 col-lg-3">
					<div class="collapse navbar-collapse">
						<ul class="nav navbar-nav navbar-right">
							<li><a href="#">Logged In as: #{userBean.loggeduser.getRole().getRole()} </a></li>
							<li>
								<h:form id="form3" style="margin-top:4%;">
									<p:commandLink action="#{userBean.logout()}"><h:outputText style="color: gray;" value="Sign out"/></p:commandLink>
								</h:form>
							</li>
						</ul>
					</div>
				</div>
			</div>			
		</div>
		<div class="container-fluid">
			<div class="row">
				<div class="col-md-2 col-lg-2 sidebar" style="padding:0;margin:0;height:100%">
					<h:form>
			<ul class="menu">
				<li>
					<p:commandLink class="menulist">
						<h:outputText value="Menu"/> 
					</p:commandLink>
				</li>
				<li>
					<p:commandLink class="menulist" action="#{userBean.showUserManager()}" disabled="#{userBean.loggeduser.getRole().getRole() != 'admin'}">
						<h:outputText value="User Manager" /> 
					</p:commandLink>
				</li>
				<li>
					<div class="dropdown" style="padding:0;margin:0">				
						<a class="dropbtn">KRI Manager</a>
						<div class="dropdown-content">
							<a href="kriManager.xhtml">Add KRI</a>
							<a href="kriManager.xhtml">Update KRI</a>
							<a href="kriManager.xhtml">Delete KRI</a>
							<a href="kriManager.xhtml">Report KRI Value</a>
						</div>
					</div>
				</li>
				<li>
					<p:commandLink class="menulist">
						<h:outputText value="Incident Register" /> 
					</p:commandLink>
				</li>
				<li>
					<p:commandLink class="menulist">
						<h:outputText value="View Report" /> 
					</p:commandLink>
				</li>
			</ul>
		</h:form>
			</div>
				<div class="col-md-10 col-lg-10 contents" style="padding:0;margin:0;">
					<p:tabView id="tabView1" style="width:100%">
    			<p:tab id="tab1" title="Create User">
    				<h:form id="form1">
    					<p:messages id="messages" closable="true"/>
    					<h:panelGrid columns="5" cellpadding="10" cellspacing="3">
    						<p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/><p:spacer width="20" height="33"/><p:spacer width="20" height="33"/>
    						<p:outputLabel for="firstname" value="Firstname: "/><p:spacer width="20"/>
    						<p:inputText size="50" id="firstname" value="#{userBean.user.firstname}" label="Firstname" required="true" requiredMessage="Firstname required" validatorMessage="Only letters (A-Z, a-z) allowed in this fields">
    							<f:validateRegex pattern="^[A-Z][a-zA-Z]+"/>
    						</p:inputText><p:spacer width="20"/>
    						<p:message for="firstname" display="text"/>
    						<p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/><p:spacer width="20" height="33"/><p:spacer width="20" height="33"/>
    						
    						<p:outputLabel for="lastname" value="Lastname: "/><p:spacer width="20"/>
    						<p:inputText size="50" id="lastname" value="#{userBean.user.lastname}" label="Lastname" required="true" requiredMessage="Lastname required" validatorMessage="Only letters (A-Z, a-z) allowed in this field">
    							<f:validateRegex pattern="^[a-zA-z]+([ '-][a-zA-Z]+)*" />
    						</p:inputText><p:spacer width="20"/>
    						<p:message for="lastname" display="text"/>
    						<p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/><p:spacer width="20" height="33"/><p:spacer width="20" height="33"/>
    						
    						<p:outputLabel for="username" value="Username: "/><p:spacer width="20"/>
    						<p:inputText size="50" id="username" value="#{userBean.user.username}" label="username" required="true" requiredMessage="Username is required" validatorMessage="Only letters and number allowed in this field">
    							<f:validateRegex pattern="^[a-zA-Z0-9]+"/>
    						</p:inputText><p:spacer width="20"/>
    						<p:message for="username" display="text"/>
    						<p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/><p:spacer width="20" height="33"/><p:spacer width="20" height="33"/>
    						
    						<p:outputLabel for="password" value="Password: "/><p:spacer width="20"/>
    						<p:password size="50" id="password" value="#{userBean.user.pwd}" label="Password" required="true" requiredMessage="Password required" /><p:spacer width="20"/>
    						<p:message for="password" display="text"/>
    						<p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/><p:spacer width="20" height="33"/><p:spacer width="20" height="33"/>
    						
    						<p:outputLabel for="email" value="Email: "/><p:spacer width="20"/>
    						<p:inputText size="50" id="email" value="#{userBean.user.email}" label="email" required="true" requiredMessage="Email required" validatorMessage="Invalid email format">
    							<f:validateRegex pattern="^[_A-Za-z0-9-\+]+(\.[_A-Za-z0-9-]+)*@[A-Za-z0-9-]+(\.[A-Za-z0-9]+)*(\.[A-Za-z]{2,})$" />
    						</p:inputText><p:spacer width="20"/>
    						<p:message for="email" display="text"/>
    						<p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/><p:spacer width="20" height="33"/><p:spacer width="20" height="33"/>
    						
    						<p:outputLabel for="role" value="Role: "/><p:spacer width="20"/>
    						<p:selectOneMenu id="role" value="#{userBean.user.role}" style="width:170px" required="true" requiredMessage="Role required" converter="selectOneMenuConverter">
    							<f:selectItem itemLabel="Select user role" itemValue=""></f:selectItem>
    							<f:selectItems value="#{roleBean.roles}" var="role" itemLabel="#{role.role}" itemValue="#{role}" />
    						</p:selectOneMenu><p:spacer width="20"/>
    						<p:message for="role" display="text"/>
    						<p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/> <p:spacer width="20" height="33"/><p:spacer width="20" height="33"/><p:spacer width="20" height="33"/>
    						
    						<p:outputLabel for="departments" value="Department: "/><p:spacer width="20"/>
    						<p:selectOneMenu id="departments" value="#{userBean.user.department}" converter="selectOneMenuConverter" style="width:190px" required="true" requiredMessage="Department is required">
    							<f:selectItem itemLabel="Select department" itemValue=""></f:selectItem>
    							<f:selectItems value="#{departmentBean.departments}" var="dept" itemLabel="#{dept.dept_name}" itemValue="#{dept}"/>
    						</p:selectOneMenu><p:spacer width="20"/>
    						<p:commandLink class="btn btn-default" onclick="PF('departmentdlg').show();">
    							<h:outputText value="Add department"/>
    						</p:commandLink>
    						<p:spacer width="20" height="32"/> <p:spacer width="20" height="32"/> <p:spacer width="20" height="32"/><p:spacer width="20" height="32"/><p:spacer width="20" height="32"/>
    						
    					</h:panelGrid><br/>
    					<p:spacer width="90" height="30"/>
    					<p:commandButton value="Create User" actionListener="#{userBean.addUser()}" update="form1"/>
    					<p:spacer width="70" height="30"/>
    					<p:commandButton value="Cancel" oncomplete="PF('userdlg').hide();"/>
    					<p:spacer width="70" height="60"/>
    				</h:form>
    			</p:tab>
    			<p:tab title="Update User">
    				<h:form id="form3">
    					<p:messages id="messages" closable="true"/>
    					<h:panelGrid columns="6" cellpadding="10" cellspacing="3">
    						<p:spacer width="100"/> 
    						<h:outputText value="Enter username to search: "/> <p:spacer width="20"/>
    						<p:inputText id="username" value="#{userBean.user.username}" label="username" required="true" requiredMessage="Username is required" validatorMessage="Only letters and number allowed in this field">
    							<f:validateRegex pattern="^[a-zA-Z0-9]+"/>
    						</p:inputText><p:spacer width="20"/>
    						<p:commandButton id="searchUser" value="Search User" actionListener="#{userBean.checkUser()}" update="@form :tabView1:form4"/>
    						<p:blockUI block="form3" trigger="searchUser">
    							LOADING<br/>
    							<p:graphicImage url="/images/status1.jpg" />
    						</p:blockUI>
    					</h:panelGrid>
    				</h:form>	
    				
    				<h:form id="form4">	
    					<h:panelGrid columns="4" cellpadding="10" cellspacing="3">
    						<p:spacer width="100" height="50"/> 
    						<p:outputLabel for="firstname" value="Firstname: "/>
    						<p:spacer width="20"/>
    						<p:inputText id="firstname" value="#{userBean.user.firstname}" label="Firstname" disabled="true" size="50"/>
    						
    						<p:spacer width="100" height="50"/> 
    						<p:outputLabel for="lastname" value="Lastname: "/>
    						<p:spacer width="20"/>
    						<p:inputText id="lastname" value="#{userBean.user.lastname}" label="Lastname" disabled="true" size="50"/>
    						
    						<p:spacer width="100" height="50"/> 
    						<p:outputLabel for="email" value="Email: "/>
    						<p:spacer width="20"/>
    						<p:inputText id="email" value="#{userBean.user.email}" label="Email" disabled="true" size="50"/>
    						
    						<p:spacer width="100"/> 
    						<p:outputLabel for="role" value="Role: "/>
    						<p:spacer width="20"/>
    						<p:selectOneMenu id="role" value="#{userBean.user.role}" style="width:170px" required="true" requiredMessage="Role required" converter="selectOneMenuConverter">
    							<f:selectItem itemLabel="Select user role" itemValue=""></f:selectItem>
    							<f:selectItems value="#{roleBean.roles}" var="role" itemLabel="#{role.role}" itemValue="#{role}" />
    						</p:selectOneMenu>
    						
    						<p:spacer width="100" height="50"/> 
    						<p:outputLabel for="departments" value="Department: "/>
    						<p:spacer width="20"/>
    						<p:selectOneMenu id="departments" value="#{userBean.user.department}" converter="selectOneMenuConverter" style="width:190px" required="true" requiredMessage="Department is required">
    							<f:selectItem itemLabel="Select department" itemValue=""></f:selectItem>
    							<f:selectItems value="#{departmentBean.departments}" var="dept" itemLabel="#{dept.dept_name}" itemValue="#{dept}"/>
    						</p:selectOneMenu>    						
    					</h:panelGrid><br/>
    					<p:spacer width="200" height="30"/>
    					<p:commandButton id="updateUser" value="Update User" actionListener="#{userBean.updateUser()}" update="@form :tabView1:form3 "/>
    					<p:blockUI block="form4" trigger="updateUser">
    							LOADING<br/>
    							<p:graphicImage url="/images/status1.jpg" />
    						</p:blockUI>
    				</h:form>	
    			</p:tab>
    			<p:tab title="Delete User">
    				<h:form id="form5">
    					<p:messages id="messages" closable="true"/>
    					<h:panelGrid columns="6" cellpadding="10" cellspacing="3">
    						<p:spacer width="100"/> 
    						<h:outputText value="Enter username to search: "/> <p:spacer width="20"/>
    						<p:inputText id="username" value="#{userBean.user.username}" label="username" required="true" requiredMessage="Username is required" validatorMessage="Only letters and number allowed in this field">
    							<f:validateRegex pattern="^[a-zA-Z0-9]+"/>
    						</p:inputText><p:spacer width="20"/>
    						<p:commandButton id="deleteUser" value="Delete User" actionListener="#{userBean.deleteUser()}" update="form5">
    							<p:confirm header="Confirmation" message="This operation will deactivate the user. Do you want to continue?" icon="ui-icon-alert"/>
    						</p:commandButton>
    						<p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
    							<p:commandButton value="Yes" type="button" styleClass="ui-confirmdialog-yes" icon="ui-icon-check" />
    							<p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="ui-icon-close" />
    						</p:confirmDialog>
    						<p:blockUI block="form5" trigger="deleteUser">
    							LOADING<br/>
    							<p:graphicImage url="/images/status1.jpg" />
    						</p:blockUI>
    					</h:panelGrid>
    				</h:form>	
    			</p:tab>
    		</p:tabView>
    		<p:dialog id="dlg2" header="Add Department" widgetVar="departmentdlg" height="150" width="420" resizable="false" position="center" draggable="false" closable="false" responsive="true" onShow="PF('departmentdlg').initPosition()">
    		<h:form id="form2">
    			<p:messages id="messages"/>
    			<h:panelGrid columns="2" cellpadding="10" cellspacing="3">
    				<p:outputLabel for="department" value="Department:  "/>
    				<p:inputText id="department" value="#{departmentBean.department.dept_name}" required="true"/>
    				<p:spacer width="20"/> <p:spacer width="20"/>
    				<p:commandButton id="addDepartment" value="Add Department" actionListener="#{departmentBean.addDepartment(departmentBean.department)}" update="messages"/>
    				
    				<p:commandButton style="margin-left:10%" value="Cancel" oncomplete="PF('departmentdlg').hide();">
    					 <p:ajax update=":tabView1:form1:departments" listener="#{departmentBean.allDepartments()}"/>
    				</p:commandButton>
    			</h:panelGrid>
    		</h:form>
    	</p:dialog> 
				</div>
			</div>
		
		</div>

</h:body>
</html>